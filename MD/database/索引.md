#### 索引类型，索引原理
聚集索引和非聚集索引

<h3 style="margin-top: 1rem; color: rgb(61, 167, 66); font-size:16px;">数据库索引为什么使用B+树</h3>
- m叉搜索树，大大降低高度
- 根到第一个节点的路径长度一样
- 实际记录行存储在同一层的叶子节点上；非叶子节点存储记录的PK，用于查询加速，适合内存存储
- 叶子之间，增加了链表，范围查找时，不再需要中序遍历
- 每个节点可以存储j个记录，如果将节点大小设置为页大小，例如4K，能够充分的利用预读的特性，极大减少磁盘IO；

<h3 style="margin-top: 1rem; color: rgb(61, 167, 66); font-size:16px;">为什么m叉的B+树比二叉搜索树的高度大大大大降低？</h3>

大概计算一下：

- (1)局部性原理，将一个节点的大小设为一页，一页4K，假设一个KEY有8字节，一个节点可以存储500个KEY，即j=500
- (2)m叉树，大概m/2<= j <=m，即可以差不多是1000叉树
- (3)那么：
  - 一层树：1个节点，1*500个KEY，大小4K
  - 二层树：1000个节点，1000*500=50W个KEY，大小1000*4K=4M
  - 三层树：1000*1000个节点，1000*1000*500=5亿个KEY，大小1000*1000*4K=4G

可以看到，存储大量的数据（5亿），并不需要太高树的深度（高度3），索引也不是太占内存（4G）。

##### 总结
- 数据库索引用于加速查询
- 虽然哈希索引是O(1)，树索引是O(log(n))，但SQL有很多“有序”需求，故数据库使用树型索引
- InnoDB不支持哈希索引
- (1)很适合磁盘存储，能够充分利用局部性原理，磁盘预读；
- (2)很低的树高度，能够存储大量数据；
- (3)索引本身占用的内存很小；
- (4)能够很好的支持单点查询，范围查询，有序性查询；

**数据预读**的思路是：磁盘读写并不是按需读取，而是按页预读，一次会读一页的数据，每次加载更多的数据，以便未来减少磁盘IO

**局部性原理**：软件设计要尽量遵循“数据读取集中”与“使用到一个数据，大概率会使用其附近的数据”，这样磁盘预读能充分提高磁盘IO
