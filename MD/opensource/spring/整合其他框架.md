
### 整合Redis

spring-boot-starter-data-redis
- 支持客户端 Jedis / Lettuce
- RedisTemplate
- Repository 支持

```
// 实体注解
@RedisHash
@Id
@Indexed
```

#### Jedis 客户端的简单使⽤
```java
@Bean
@ConfigurationProperties("redis")
public JedisPoolConfig jedisPoolConfig() {
  return new JedisPoolConfig()
}

@Bean(destroyMethod = "close")
public JedisPool jedisPool(@Value("${redis.host}") String host) {
  return new JedisPool(jedisPoolConfig(), host)
}
```

##### Example

```java
public class Example {

    // inject the actual template
    @Autowired
    private RedisTemplate<String, String> redisTemplate;

    // inject the template as ListOperations
    // can also inject as Value, Set, ZSet, and HashOperations
    @Resource(name="redisTemplate")
    private ListOperations<String, String> listOps;

    public void addLink(String userId, URL url) {
        listOps.leftPush(userId, url.toExternalForm());
        // or use template directly
        redisTemplate.boundListOps(userId).leftPush(url.toExternalForm());
    }
    
    @Autowired
    private StringRedisTemplate stringRedisTemplate;
    
    public void addLink(String userId, URL url) {
        stringRedisTemplate.opsForList().leftPush(userId, url.toExternalForm());
    }
}
```


### Redis 的哨兵与集群模式
Redis Sentinel 是 Redis 的一种⾼可用⽅案: 监控、通知、自动故障转移、服务发现

JedisSentinelPool 

#### Redis Cluster
- 数据自动分片（16384个 Hash Slot）
- 部分节点失效时有一定可用性

JedisCluster 
- Jedis 只从 Master 读数据，如果想要⾃自动读写分离，可以定制

```yaml
spring.redis:
  database: 0 # Redis数据库索引（默认为0）
  #host: 192.168.1.8
  #port: 6379
  password: 123
  timeout: 3000 # 连接超时时间（毫秒）  
  pool:
    max-active: 8 # 连接池最大连接数（使用负值表示没有限制）
    max-idle: 8 # 连接池中的最大空闲连接
    max-wait: -1 # 连接池最大阻塞等待时间（使用负值表示没有限制）
    min-idle: 0 # 连接池中的最小空闲连接
  cluster:
    nodes:
      - 192.168.1.8:9001
      - 192.168.1.8:9002
      - 192.168.1.8:9003
```